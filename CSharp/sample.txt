using System;  
using System.IO;  
using System.Net;  
using System.Text;  
  
namespace SampleCode.System.Net  
{  
    public class WebRequestSampleCode 
    {  
        public static void callAPI(String accessToken)  
        {  
            Uri url = new Uri(${endpoint})
             // Create a request for the URL.   
            WebRequest request = WebRequest.Create(url);  
            // If required by the server, set the credentials.  
            HttpWebRequest httpRequest = (HttpWebRequest)request;
            //Request authentication
            httpRequest.PreAuthenticate = true;
            httpRequest.Headers.Add("Authorization", "Bearer " + AccessToken);
            //Request method
            httpRequest.Method = ${method};
            //Request content type
            httpRequest.Accept = "application/json";
            // Get the response.  
            WebResponse response = request.GetResponse();  
            // Display the status.  
            Console.WriteLine (((HttpWebResponse)response).StatusDescription);  
            // Get the stream containing content returned by the server.  
            Stream dataStream = response.GetResponseStream();  
            //Validates if dataStream is not empty
            if (dataStream == null) return null;
            // Open the stream using a StreamReader for easy access.  
            StreamReader reader = new StreamReader(dataStream);  
            // Read the content.  
            string responseFromServer = reader.ReadToEnd();  
            // Display the content.  
            Console.WriteLine(responseFromServer);  
            // Clean up the streams and the response.  
            reader.Close();  
            response.Close();  
        }  
    }  
}  
